<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Thing Maker</title>
<meta name="author" content="Derrick Oswald" />
<!-- Date: 2013-03-27 -->
<script language="JavaScript" type="text/javascript" src="./bencoder.js"></script>
<script language="JavaScript" type="text/javascript" src="./sha1.js"></script>
<script language="JavaScript" type="text/javascript" src="./ThingMaker.js"></script>

<!-- all of the crap below is used by the jsrsasign code -->
<!-- assumes that a git clone was performed into the jsrsasign directory within the thingmaker directory -->
<!-- e.g. thing-tracker-network\thingmaker>git clone https://github.com/derrickoswald/jsrsasign.git jsrsasign -->
<!-- Note: this will *not* be added to the thingmaker repository, and hence must be performed separately -->

<script language="JavaScript" type="text/javascript" src="jsrsasign/ext/jsbn.js"></script>
<script language="JavaScript" type="text/javascript" src="jsrsasign/ext/jsbn2.js"></script>
<script language="JavaScript" type="text/javascript" src="jsrsasign/ext/rsa.js"></script>
<script language="JavaScript" type="text/javascript" src="jsrsasign/ext/rsa2.js"></script>
<script language="JavaScript" type="text/javascript" src="jsrsasign/ext/base64.js"></script>

<!-- for crypto.js -->
<script language="JavaScript" type="text/javascript" src="crypto-js/core.js"></script>
<script language="JavaScript" type="text/javascript" src="crypto-js/md5.js"></script>
<script language="JavaScript" type="text/javascript" src="crypto-js/sha1.js"></script>
<script language="JavaScript" type="text/javascript" src="crypto-js/sha256.js"></script>
<script language="JavaScript" type="text/javascript" src="crypto-js/ripemd160.js"></script>
<script language="JavaScript" type="text/javascript" src="crypto-js/x64-core.js"></script>
<script language="JavaScript" type="text/javascript" src="crypto-js/sha512.js"></script>

<script language="JavaScript" type="text/javascript" src="jsrsasign/rsapem-1.1.js"></script>
<script language="JavaScript" type="text/javascript" src="jsrsasign/rsasign-1.2.js"></script>
<script language="JavaScript" type="text/javascript" src="jsrsasign/asn1hex-1.1.js"></script>
<script language="JavaScript" type="text/javascript" src="jsrsasign/x509-1.1.js"></script>
<script language="JavaScript" type="text/javascript" src="jsrsasign/crypto-1.1.js"></script>
<!-- end.. all of the crap -->

<script language="JavaScript" type="text/javascript" src="./ThingSigner.js"></script>

<link href="./css/bootstrap/bootstrap.css" rel="stylesheet">
<link href="./css/thingtracker.css" rel="stylesheet" media="screen" type="text/css">
<link href="./css/thingmaker.css" rel="stylesheet" media="screen" type="text/css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="./css/bootstrap/bootstrap-responsive.css" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span2"></div>
            <div class="span8">
                <h1>Thing Maker</h1>
                <p>
                    <strong>Create a distributed <em>Thing</em> using the BitTorrent network.
                    </strong>
                </p>
                <div class="row-fluid">
                    <div class="span12">
                        The idea behind the Thing Maker is to use <a href="https://en.wikipedia.org/wiki/Bittorrent">BitTorrent</a>
                        to distribute <a href="http://thingtracker.net/">Thing Tracker things</a>. <br>
                        A short overview of the idea can be found <a href="http://my.brainshark.com/Distributed-Thing-Tracker-767853647">here</a>. <br> <br>
                        This page helps with the steps of the process shown below:
                    </div>
                </div>
                <!-- embed the image instead of referencing it img src="./assets/Thing%20Maker.svg" -->
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="926.6875"
   height="242.21875"
   id="svg2"
   version="1.1"
   inkscape:version="0.48.4 r9939"
   sodipodi:docname="Thing Maker.svg">
  <defs
     id="defs4" />
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="1.8992379"
     inkscape:cx="463.34375"
     inkscape:cy="121.10937"
     inkscape:document-units="px"
     inkscape:current-layer="layer1"
     showgrid="false"
     inkscape:window-width="1920"
     inkscape:window-height="1019"
     inkscape:window-x="-9"
     inkscape:window-y="-9"
     inkscape:window-maximized="1"
     fit-margin-top="20"
     fit-margin-left="20"
     fit-margin-right="20"
     fit-margin-bottom="20" />
  <metadata
     id="metadata7">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(65.4375,-44.34375)">
    <text
       xml:space="preserve"
       style="font-size:16px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;font-family:Frutiger Next LT W1G;-inkscape-font-specification:Frutiger Next LT W1G"
       x="398.88214"
       y="190.07648"
       id="text3755-7"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         id="tspan3757-4"
         x="398.88214"
         y="190.07648"
         style="text-align:center;text-anchor:middle">Step 3.</tspan><tspan
         sodipodi:role="line"
         x="398.88214"
         y="210.07648"
         id="tspan3763-9"
         style="text-align:center;text-anchor:middle">Add or update</tspan><tspan
         sodipodi:role="line"
         x="398.88214"
         y="230.07648"
         style="text-align:center;text-anchor:middle"
         id="tspan3797"><tspan
   style="font-style:italic"
   id="tspan3107">Thing </tspan>metadata</tspan><tspan
         sodipodi:role="line"
         x="398.88214"
         y="250.07648"
         style="text-align:center;text-anchor:middle"
         id="tspan3937">by filling the form.</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:16px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;font-family:Frutiger Next LT W1G;-inkscape-font-specification:Frutiger Next LT W1G"
       x="773.56573"
       y="196.4241"
       id="text3755-7-8"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         x="773.56573"
         y="196.4241"
         style="text-align:center;text-anchor:middle"
         id="tspan3797-4">Step 5.</tspan><tspan
         sodipodi:role="line"
         x="773.56573"
         y="216.4241"
         style="text-align:center;text-anchor:middle"
         id="tspan3835">Seed and publish</tspan><tspan
         sodipodi:role="line"
         x="773.56573"
         y="236.4241"
         style="text-align:center;text-anchor:middle"
         id="tspan3121">your <tspan
   style="font-style:italic"
   id="tspan3837">Thing</tspan>.</tspan></text>
    <rect
       style="fill:none;stroke:#008080;stroke-width:2.2925272;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       id="rect2985-17"
       width="137.13605"
       height="99.2789"
       x="-44.286758"
       y="166.14178"
       ry="1.9259558" />
    <text
       xml:space="preserve"
       style="font-size:16px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;font-family:Frutiger Next LT W1G;-inkscape-font-specification:Frutiger Next LT W1G"
       x="26.331375"
       y="196.4241"
       id="text3755-4"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         id="tspan3757-0"
         x="26.331375"
         y="196.4241"
         style="text-align:center;text-anchor:middle">Step 1.</tspan><tspan
         sodipodi:role="line"
         x="26.331375"
         y="216.4241"
         style="text-align:center;text-anchor:middle"
         id="tspan3079">Select the files</tspan><tspan
         sodipodi:role="line"
         x="26.331375"
         y="236.4241"
         style="text-align:center;text-anchor:middle"
         id="tspan3935">for your <tspan
   style="font-style:italic"
   id="tspan3115">Thing</tspan>.</tspan></text>
    <rect
       style="fill:none;stroke:#008080;stroke-width:2.2925272;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       id="rect2985-17-5"
       width="137.13605"
       height="99.2789"
       x="328.64178"
       y="166.14178"
       ry="1.9259558" />
    <rect
       style="fill:none;stroke:#008080;stroke-width:2.2925272;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       id="rect2985-17-51"
       width="137.13605"
       height="99.2789"
       x="702.96326"
       y="164.71321"
       ry="1.9259558" />
    <g
       id="g3047"
       transform="translate(10,0)">
      <path
         inkscape:connector-curvature="0"
         id="path3843-5"
         d="m 456.5279,219.57647 230.39002,0"
         style="fill:none;stroke:#008080;stroke-width:2.70000005;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" />
      <path
         inkscape:transform-center-y="-0.0027414005"
         inkscape:transform-center-x="-0.73726806"
         transform="matrix(0.16847952,0.98570515,-0.98570515,0.16847952,712.50264,-25.031795)"
         d="m 239.40616,67.511834 -2.52477,-0.436357 -2.52478,-0.436357 1.64028,-1.96834 1.64029,-1.96834 0.88449,2.404697 z"
         inkscape:randomized="0"
         inkscape:rounded="0"
         inkscape:flatsided="false"
         sodipodi:arg2="1.7419358"
         sodipodi:arg1="0.69473828"
         sodipodi:r2="1.4792894"
         sodipodi:r1="2.9585788"
         sodipodi:cy="65.617798"
         sodipodi:cx="237.13332"
         sodipodi:sides="3"
         id="path3845-1"
         style="fill:none;stroke:#008080;stroke-width:3;stroke-linecap:butt;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
         sodipodi:type="star" />
      <text
         sodipodi:linespacing="125%"
         id="text3755-7-8-1"
         y="89.209808"
         x="572.62665"
         style="font-size:16px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;font-family:Frutiger Next LT W1G;-inkscape-font-specification:Frutiger Next LT W1G"
         xml:space="preserve"><tspan
           id="tspan3797-4-7"
           style="text-align:center;text-anchor:middle"
           y="89.209808"
           x="572.62665"
           sodipodi:role="line">Step 4.</tspan><tspan
           id="tspan3835-4"
           style="text-align:center;text-anchor:middle"
           y="109.20981"
           x="572.62665"
           sodipodi:role="line">Optionally</tspan><tspan
           id="tspan3939"
           style="text-align:center;text-anchor:middle"
           y="129.20981"
           x="572.62665"
           sodipodi:role="line">sign your</tspan><tspan
           id="tspan3121-0"
           style="text-align:center;text-anchor:middle"
           y="149.20981"
           x="572.62665"
           sodipodi:role="line"><tspan
   id="tspan3837-9"
   style="font-style:italic">Thing</tspan>.</tspan></text>
      <path
         inkscape:transform-center-y="-0.0027414005"
         inkscape:transform-center-x="-0.73726806"
         transform="matrix(0.16847952,0.98570515,-0.98570515,0.16847952,523.56359,-124.24608)"
         d="m 239.40616,67.511834 -2.52477,-0.436357 -2.52478,-0.436357 1.64028,-1.96834 1.64029,-1.96834 0.88449,2.404697 z"
         inkscape:randomized="0"
         inkscape:rounded="0"
         inkscape:flatsided="false"
         sodipodi:arg2="1.7419358"
         sodipodi:arg1="0.69473828"
         sodipodi:r2="1.4792894"
         sodipodi:r1="2.9585788"
         sodipodi:cy="65.617798"
         sodipodi:cx="237.13332"
         sodipodi:sides="3"
         id="path3845-1-4"
         style="fill:none;stroke:#008080;stroke-width:3;stroke-linecap:butt;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
         sodipodi:type="star" />
      <rect
         ry="1.9259558"
         y="65.498932"
         x="504.0242"
         height="99.2789"
         width="137.13605"
         id="rect2985-17-51-5"
         style="fill:none;stroke:#008080;stroke-width:2.2925272;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" />
      <path
         sodipodi:nodetypes="cccc"
         inkscape:connector-curvature="0"
         id="path3893"
         d="m 455.99555,219.55033 15.98477,0.0217 0.42214,-99.30722 c 7.36144,-0.12642 14.93848,-0.12642 23.42349,-0.12642"
         style="fill:none;stroke:#008080;stroke-width:2.70171595;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:5.40343205, 2.70171603;stroke-dashoffset:0" />
      <path
         inkscape:transform-center-y="0.73726923"
         inkscape:transform-center-x="-0.0027365073"
         transform="matrix(-0.98570515,0.16847952,-0.16847952,-0.98570515,910.6125,239.2834)"
         d="m 239.40616,67.511834 -2.52477,-0.436357 -2.52478,-0.436357 1.64028,-1.96834 1.64029,-1.96834 0.88449,2.404697 z"
         inkscape:randomized="0"
         inkscape:rounded="0"
         inkscape:flatsided="false"
         sodipodi:arg2="1.7419358"
         sodipodi:arg1="0.69473828"
         sodipodi:r2="1.4792894"
         sodipodi:r1="2.9585788"
         sodipodi:cy="65.617798"
         sodipodi:cx="237.13332"
         sodipodi:sides="3"
         id="path3845-1-4-1"
         style="fill:none;stroke:#008080;stroke-width:3;stroke-linecap:butt;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
         sodipodi:type="star" />
      <path
         sodipodi:nodetypes="cccc"
         inkscape:connector-curvature="0"
         id="path3893-5"
         d="m 681.78538,219.54778 -15.98477,0.0217 -0.42214,-99.30722 c -7.36144,-0.12642 -14.93848,-0.12642 -23.42349,-0.12642"
         style="fill:none;stroke:#008080;stroke-width:2.70171595;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:5.40343205, 2.70171603;stroke-dashoffset:0" />
    </g>
    <g
       transform="translate(-363.42021,1.639088)"
       id="g3047-1">
      <path
         inkscape:connector-curvature="0"
         id="path3843-5-7"
         d="m 456.5279,219.57647 230.39002,0"
         style="fill:none;stroke:#008080;stroke-width:2.70000005;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" />
      <path
         inkscape:transform-center-y="-0.0027414005"
         inkscape:transform-center-x="-0.73726806"
         transform="matrix(0.16847952,0.98570515,-0.98570515,0.16847952,712.50264,-25.031795)"
         d="m 239.40616,67.511834 -2.52477,-0.436357 -2.52478,-0.436357 1.64028,-1.96834 1.64029,-1.96834 0.88449,2.404697 z"
         inkscape:randomized="0"
         inkscape:rounded="0"
         inkscape:flatsided="false"
         sodipodi:arg2="1.7419358"
         sodipodi:arg1="0.69473828"
         sodipodi:r2="1.4792894"
         sodipodi:r1="2.9585788"
         sodipodi:cy="65.617798"
         sodipodi:cx="237.13332"
         sodipodi:sides="3"
         id="path3845-1-40"
         style="fill:none;stroke:#008080;stroke-width:3;stroke-linecap:butt;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
         sodipodi:type="star" />
      <text
         sodipodi:linespacing="125%"
         id="text3755-7-8-1-9"
         y="89.209808"
         x="572.62665"
         style="font-size:16px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;font-family:Frutiger Next LT W1G;-inkscape-font-specification:Frutiger Next LT W1G"
         xml:space="preserve"><tspan
           id="tspan3121-0-2"
           style="text-align:center;text-anchor:middle"
           y="89.209808"
           x="572.62665"
           sodipodi:role="line">Step 2.</tspan><tspan
           style="text-align:center;text-anchor:middle"
           y="109.20981"
           x="572.62665"
           sodipodi:role="line"
           id="tspan3129">Provide any prior</tspan><tspan
           style="text-align:center;text-anchor:middle"
           y="129.20981"
           x="572.62665"
           sodipodi:role="line"
           id="tspan3131">version Thing file</tspan><tspan
           style="text-align:center;text-anchor:middle"
           y="149.20981"
           x="572.62665"
           sodipodi:role="line"
           id="tspan3133">as a template.</tspan></text>
      <path
         inkscape:transform-center-y="-0.0027414005"
         inkscape:transform-center-x="-0.73726806"
         transform="matrix(0.16847952,0.98570515,-0.98570515,0.16847952,523.56359,-124.24608)"
         d="m 239.40616,67.511834 -2.52477,-0.436357 -2.52478,-0.436357 1.64028,-1.96834 1.64029,-1.96834 0.88449,2.404697 z"
         inkscape:randomized="0"
         inkscape:rounded="0"
         inkscape:flatsided="false"
         sodipodi:arg2="1.7419358"
         sodipodi:arg1="0.69473828"
         sodipodi:r2="1.4792894"
         sodipodi:r1="2.9585788"
         sodipodi:cy="65.617798"
         sodipodi:cx="237.13332"
         sodipodi:sides="3"
         id="path3845-1-4-5"
         style="fill:none;stroke:#008080;stroke-width:3;stroke-linecap:butt;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
         sodipodi:type="star" />
      <rect
         ry="1.9259558"
         y="65.498932"
         x="504.0242"
         height="99.2789"
         width="137.13605"
         id="rect2985-17-51-5-5"
         style="fill:none;stroke:#008080;stroke-width:2.2925272;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none" />
      <path
         sodipodi:nodetypes="cccc"
         inkscape:connector-curvature="0"
         id="path3893-1"
         d="m 455.99555,219.55033 15.98477,0.0217 0.42214,-99.30722 c 7.36144,-0.12642 14.93848,-0.12642 23.42349,-0.12642"
         style="fill:none;stroke:#008080;stroke-width:2.70171595;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:5.40343205, 2.70171603;stroke-dashoffset:0" />
      <path
         inkscape:transform-center-y="0.73726923"
         inkscape:transform-center-x="-0.0027365073"
         transform="matrix(-0.98570515,0.16847952,-0.16847952,-0.98570515,910.6125,239.2834)"
         d="m 239.40616,67.511834 -2.52477,-0.436357 -2.52478,-0.436357 1.64028,-1.96834 1.64029,-1.96834 0.88449,2.404697 z"
         inkscape:randomized="0"
         inkscape:rounded="0"
         inkscape:flatsided="false"
         sodipodi:arg2="1.7419358"
         sodipodi:arg1="0.69473828"
         sodipodi:r2="1.4792894"
         sodipodi:r1="2.9585788"
         sodipodi:cy="65.617798"
         sodipodi:cx="237.13332"
         sodipodi:sides="3"
         id="path3845-1-4-1-7"
         style="fill:none;stroke:#008080;stroke-width:3;stroke-linecap:butt;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
         sodipodi:type="star" />
      <path
         sodipodi:nodetypes="cccc"
         inkscape:connector-curvature="0"
         id="path3893-5-1"
         d="m 681.78538,219.54778 -15.98477,0.0217 -0.42214,-99.30722 c -7.36144,-0.12642 -14.93848,-0.12642 -23.42349,-0.12642"
         style="fill:none;stroke:#008080;stroke-width:2.70171595;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:5.40343205, 2.70171603;stroke-dashoffset:0" />
    </g>
  </g>
</svg>
                <div class="step">
                    <h2>STEP 1</h2>
                    Identify the files to be included in your <em>Thing</em>. <br>
                    Currently, you can either select a single file by clicking on the button below and using the "File Upload"
                    dialog to navigate to and identify the file,
                    or you can drag and drop a list of files onto the button
                    (this only works in FireFox but will be fixed eventually),
                    but then you must specify the directory for the files.
                    <div id="choose_thing_form">
                        Select file(s): <input id="thing_files" type="file" name="file" />
                    </div>
                    <div id="choose_thing_directory">
                        Directory: <input id="thing_directory" type="text" name="directory" />
                    </div>
                    <div id="info_hash"></div>
                    <div id="file_content"></div>
                </div>
                <div class="step">
                    <h2>STEP 2</h2>
                    <em>This step is optional.</em><br>
                    Choose a torrent file that will be used as a basis for the <em>Thing</em> you create.<br>
                    This can be a torrent file from a previous version of your <em>Thing</em>, or just a template torrent file
                    that has mostly the same metadata as you will be filling in in Step 3.
                    <div id="choose_torrent_basis_form">
                        Choose a base torrent file: <input id="torrent_files" type="file" name="file" disabled="disabled" />
                    </div>
                    <div id="byte_content"></div>
                </div>
                <div class="step">
                    <h2>STEP 3</h2>
                    Fill in this form with the metadata for your <em>Thing</em> and press the <b>Make Thing</b> button.<br>
                    For details about the fields, consult the <a href="http://thingtracker.net/#specification">specification</a>.
                    Authors, licenses and tags are comma separated.
                    <form id="thing_form" action="javascript:submit_form ();">
                        <ul>
                            <li><label class="thing_form_label" form="thing_form" for="title">Title</label><input id="title"
                                form="thing_form" type="text" name="title"></li>
                            <li><label class="thing_form_label" form="thing_form" for="url">URL</label><input id="url"
                                form="thing_form" type="text" name="url"></li>
                            <li><label class="thing_form_label" form="thing_form" for="authors">Authors</label><input id="authors"
                                form="thing_form" type="text" name="authors"></li>
                            <li><label class="thing_form_label" form="thing_form" for="licenses">Licenses</label><input
                                id="licenses" form="thing_form" type="text" name="licenses"></li>
                            <li><label class="thing_form_label" form="thing_form" for="tags">Tags</label><input id="tags"
                                form="thing_form" type="text" name="tags"></li>
                            <li><label class="thing_form_label" form="thing_form" for="thumbnailURL">Thumbnail URL</label><input
                                id="thumbnailURL" form="thing_form" type="text" name="thumbnailURL"></li>
                            <li><label class="thing_form_label" form="thing_form" for="description">Description</label><input
                                id="description" form="thing_form" type="text" name="description"></li>
                            <li><input class="thing_form_button" form="thing_form" type="submit" value="Make Thing"
                                name="make_thing" disabled="disabled"></li>
                        </ul>
                    </form>
                </div>
                <div class="step">
                    <h2>STEP 4</h2>
                    You can optionally sign your <em>Thing</em> by providing the private key in PEM format.
                    Also supply the corresponding public certificate if it has not been widely distributed already,
                    and this will be included in the signatures section.
                    If this is a new version of the <em>Thing</em> you supplied in step 2,
                    include the new version identifier, the cleartext of the previous version's nonce,
                    and a new nonce (that you must remember somehow for next time) for the next version.
                    <form id="signing_form" action="javascript:sign_thing ();">
                        <ul>
                            <li>
                                <label class="signing_form_label" form="signing_form" for="private_key">Private Key</label>
                                <textarea id="private_key" form="signing_form" type="text" name="private_key" rows="16" cols="65">-----BEGIN RSA PRIVATE KEY-----
MIICXQIBAAKBgQC/875gQ3CrLKmf6Ag/sLtK/Y0wnEmzwBOSJY1ecGBoLrPc6Hdc
NCK0eAwcB70A62VBOQZJ4mbyQwKmCaIUNDzBnDAO4p+5UCB4WWvwIILBXDRR2bP8
fzcVkP7AFylUxwYZShJz1FS0PQb//i6jav9Q4oZuzveUVR/oJuSIF9n2OwIDAQAB
AoGAMUmpDJbEi2+Abqrp01DSBsNsSZsX4avkWpaB4koAtz+mt4aJf4dzkdtxYJEs
GtxWt5So5LfZr0M9ntzCXWW8Y5gyoErXXErZ8dR9pnyuinxZ3Cg6bKQnwYqoEYQi
XpDpAm+ACcj68MstMcn8LdrUfoga0zBHcd9CM8Xp6T1zduECQQDxV+KEHquj+887
zfv3Ed0jRSNfdn4snOOHYQbD1WMV/XyI/TQG7dQC/iHNNoHpJr14oSFPVMUAMVa4
OsViDuSNAkEAy5v7+GbHarHDfOriilxluugdd+N7TT3MQg+x9Z6BnXIy3aUz+1VS
5geyc7FdGGqY8SWSdNNGf2edijP3S4ln5wJBAJZkRKQ+FIlIVjgXQQcSW7Ip2EQZ
q8CTN3naLYQFSgye/GbFGhGjTHVc9aVSbRvj5zfveLldwrE/DaIaBXv4edUCQQC4
/x8vkWL7REzUgS4YfN9JtYCg36W2hsHB/DS7cKtf/NTOoj3azKmnq7Kuf6aQero/
0N2DHDvfoqt3WMQGc/BdAkBFHysNWAIqF3qZYpsFKip9anfB0xWLi/YRUE0IoCXi
LrvSlhBrIatVmU1NzJetJNXtMqyOFfTJTJDtJOkritTQ
-----END RSA PRIVATE KEY-----</textarea>
                            </li>
                            <li>
                                <label class="signing_form_label" form="signing_form" for="certificate">Certificate</label>
                                <textarea id="certificate" form="signing_form" type="text" name="certificate" rows="30" cols="65">-----BEGIN CERTIFICATE-----
MIIE/zCCAuegAwIBAgIDDeFpMA0GCSqGSIb3DQEBBQUAMHkxEDAOBgNVBAoTB1Jv
b3QgQ0ExHjAcBgNVBAsTFWh0dHA6Ly93d3cuY2FjZXJ0Lm9yZzEiMCAGA1UEAxMZ
Q0EgQ2VydCBTaWduaW5nIEF1dGhvcml0eTEhMB8GCSqGSIb3DQEJARYSc3VwcG9y
dEBjYWNlcnQub3JnMB4XDTEzMTAwMTE1MzYxOVoXDTE0MDMzMDE1MzYxOVowQzEY
MBYGA1UEAxMPQ0FjZXJ0IFdvVCBVc2VyMScwJQYJKoZIhvcNAQkBFhhkZXJyaWNr
Lm9zd2FsZEBnbWFpbC5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAL/z
vmBDcKssqZ/oCD+wu0r9jTCcSbPAE5IljV5wYGgus9zod1w0IrR4DBwHvQDrZUE5
BkniZvJDAqYJohQ0PMGcMA7in7lQIHhZa/AggsFcNFHZs/x/NxWQ/sAXKVTHBhlK
EnPUVLQ9Bv/+LqNq/1Dihm7O95RVH+gm5IgX2fY7AgMBAAGjggFIMIIBRDAMBgNV
HRMBAf8EAjAAMFYGCWCGSAGG+EIBDQRJFkdUbyBnZXQgeW91ciBvd24gY2VydGlm
aWNhdGUgZm9yIEZSRUUgaGVhZCBvdmVyIHRvIGh0dHA6Ly93d3cuQ0FjZXJ0Lm9y
ZzAOBgNVHQ8BAf8EBAMCA6gwQAYDVR0lBDkwNwYIKwYBBQUHAwQGCCsGAQUFBwMC
BgorBgEEAYI3CgMEBgorBgEEAYI3CgMDBglghkgBhvhCBAEwMgYIKwYBBQUHAQEE
JjAkMCIGCCsGAQUFBzABhhZodHRwOi8vb2NzcC5jYWNlcnQub3JnMDEGA1UdHwQq
MCgwJqAkoCKGIGh0dHA6Ly9jcmwuY2FjZXJ0Lm9yZy9yZXZva2UuY3JsMCMGA1Ud
EQQcMBqBGGRlcnJpY2sub3N3YWxkQGdtYWlsLmNvbTANBgkqhkiG9w0BAQUFAAOC
AgEAWbvHj+d+OlhDW3OdWIF6bzapS2zyr5eAb1+5SaDCIXjwO/DwtAtxhHIigYi1
Nf8yOafoqyIAgWj9NCo8gboEXLkDNSMiDkZew84X3LckDr3FH6Xs23PjIAjKLhcT
B0e2e7XSiNOcZlh/2BSWOzE9d3vAYPK/vfWiU2cde9Y38WKGm2FItkGTgJ6I9mt7
Y9mxkYmlSUy/iJcu+uez8Gs0xRYIsrjB+17gpox4+dJVPWBdLE+YNGTtvdOdvLU3
g9n/D6WewQt0iAcwNMGbhpFahL5Cw5WMwvytT1ZWq6WvJegUNxz8cWWBT8C1AIjp
1JusGTvQq68StbpxYnL/PqyNs2F6KzFvy08Q+FkHPE+1wdZs/VJqrU86q4qjRYEn
uLr4gowHYtsTb2z4XP4JbVDTpKocfCz/RmefMsCcJkKgER+PFtL+TPQiTr2yNS1F
oMDEsQqsikCj0zpqul73uRzlz1Kazr9ODnpyNKdB3hI+E3maOjJyBPCfxv3Qkiiy
7vezNlshxcOXyTZsjCNtph31EtKmqDjst6zmDa0k+IAniIzp7s05R9APobv+rN2S
VGcdtbUuU6dAmdC14SFHtHP4OCLNN/siqEWA2smTQjUX52po2ilI/QHVhB11AtPn
tiVNNk2MZ6PDp0Kfzmf0FfT1TJELXrsM4VuQVsqdhDBDvmI=
-----END CERTIFICATE-----</textarea>
                            </li>
                            <li>
                                <label class="signing_form_label" form="signing_form" for="version">Version</label>
                                <input id="version" form="signing_form" type="text" name="version" placeholder="v1.0.0">
                            </li>
                            <li>
                                <label class="signing_form_label" form="signing_form" for="nonce">Nonce</label>
                                <textarea id="nonce" form="signing_form" type="text" name="nonce" rows="5" cols="65"></textarea>
                            </li>
                            <li>
                                <label class="signing_form_label" form="signing_form" for="next_nonce">Next nonce</label>
                                <textarea id="next_nonce" form="signing_form" type="text" name="next_nonce" rows="5" cols="65"></textarea>
                            </li>
                            <li>
                                <input class="signing_form_button" form="signing_form" type="submit" value="Sign Thing"
                                name="sign_thing" disabled="disabled">
                            </li>
                        </ul>
                    </form>
                </div>
                <div class="step">
                    <h2>STEP 5</h2>
                    Download the torrent file by clicking on the link below, save it, and together
                    with the files that you specified in the base torrent file in Step 1,
                    seed your thing in your BitTorrent client.
                    <div id="bencode_content"></div>
                    Then you can publish your <em>Thing</em> by proudly displaying this magnet link.
                    <div id="magnet_content"></div>
                    <div id="torrent_content"></div>
                </div>
            </div>
            <div class="span2"></div>
        </div>
    </div>
    <script language="JavaScript" type="text/javascript">
                    // torrent to use as a base
                    var TorrentFile = null;
                    var TorrentFileName = null;
                    var Torrent = null;

                    function format (text)
                    {
                        var pre = document.createElement ("pre");
                        var code = document.createElement ("code");
                        pre.appendChild (code);
                        var pieces = text.split ('\n');
                        for ( var i = 0; i < pieces.length; i++)
                        {
                            code.appendChild (document.createTextNode (pieces[i]));
                            code.appendChild (document.createElement ("br"));
                        }

                        return (pre);
                    }

                    function clean_add (element, node)
                    {
                        var content = document.getElementById (element);
                        var child = content.firstChild;
                        while (null != child)
                        {
                            content.removeChild (child);
                            child = content.firstChild;
                        }
                        content.appendChild (node);
                    }

                    // show the contents of the Thing object in the content area
                    function showcontent (torrent, element)
                    {
                        // show the torrent contents
                        var raw_text = torrent.toString ();
                        clean_add (element, format (raw_text));
                    }

                    // copy the Thing properties, if found, to the input fields of the form
                    function fillform (torrent)
                    {
                        var thing = torrent["info"]["thing"];
                        if (null != thing)
                        {
                            var form = document.getElementById ('thing_form');
                            if (null != form)
                            {
                                for (i = 0; i < form.elements.length; i++)
                                {
                                    var child = form.elements[i];
                                    var id = child.getAttribute ("id");
                                    if (null != id)
                                    {
                                        var value = thing[id];
                                        // based on the type, assign the value
                                        if (null != value)
                                            child.value = value;
                                    }
                                }
                            }
                        }
                    }

                    // enable the Make Thing button
                    function enablebutton ()
                    {
                        var elements = document.getElementsByName ("make_thing");
                        for (i = 0; i < elements.length; i++)
                            elements[i].removeAttribute ("disabled");
                        var files = document.getElementById ('torrent_files');
                        files.removeAttribute ("disabled");
                    }

                    // disable the Make Thing button
                    function disablebutton ()
                    {
                        var elements = document.getElementsByName ("make_thing");
                        for (i = 0; i < elements.length; i++)
                            elements[i].setAttribute ("disabled", "disabled");
                        var files = document.getElementById ('torrent_files');
                        files.setAttribute ("disabled", "disabled");
                    }

                    // enable the Sign Thing button
                    function enablesigning ()
                    {
                        var elements = document.getElementsByName ("sign_thing");
                        for (i = 0; i < elements.length; i++)
                            elements[i].removeAttribute ("disabled");
                    }

                    // callback for reading the torrent file
                    function cb (filename, torrent)
                    {
                        TorrentFileName = filename;
                        // replace the existing pieces with the current pieces
                        Torrent = MakeTorrent (torrent);
                        enablebutton ();
                        showcontent (torrent, "byte_content");
                        fillform (torrent);
                    }

                    // make a title for the thing
                    function maketitle ()
                    {
                        var title;

                        if (Torrent["info"] && Torrent["info"]["thing"] && Torrent["info"]["thing"]["title"])
                            title = Torrent["info"]["thing"]["title"];
                        if (null == title)
                        {
                            var thing_file = TorrentFileName || "Thing"; // default name is the file name
                            var n = thing_file.lastIndexOf (".");
                            if (-1 == n)
                                title = thing_file;
                            else
                                title = thing_file.substring (0, n);
                        }
                        title = title.replace (/\&/g, "and");
                        title = title.replace (/ /g, "%20");

                        return (title);
                    }

                    // show the contents of the encoded Thing as a link in the content area
                    function showlink (torrent)
                    {
                        // show the torrent contents
                        var a = document.createElement ("a");
                        a.setAttribute ("href", "data:application/octet-stream;base64," + btoa (torrent));
                        a.setAttribute ("download", maketitle () + ".torrent");
                        var text = document.createTextNode ("Torrent File");
                        a.appendChild (text);
                        var content = document.getElementById ('bencode_content');
                        var child = content.firstChild;
                        while (null != child)
                        {
                            content.removeChild (child);
                            child = content.firstChild;
                        }
                        content.appendChild (a);
                    }

                    // show the magnet url as a link in the content area
                    function showmagnet ()
                    {
                        // generate the 160 bit (40 hex characters) info primary key magnet URL
                        var title = maketitle ();
                        var info = Torrent["info"];
                        var primary_key = info_hash (info);
                        var magnet = "magnet:?xt=urn:btih:" + primary_key + "&dn=" + title;

                        // show the magnet link URI
                        var a = document.createElement ("a");
                        a.setAttribute ("href", magnet);
                        a.setAttribute ("title", "Download this torrent using magnet");
                        var img = document.createElement ("img");
                        a.appendChild (img);
                        img.setAttribute ("id", "magnet_icon");
                        img.setAttribute ("src", "https://upload.wikimedia.org/wikipedia/commons/7/7c/Magnet_icon.svg");
                        img.setAttribute ("height", "48");
                        img.setAttribute ("width", "48");
                        var text = document.createTextNode ("Magnet Link");
                        a.appendChild (text);
                        var content = document.getElementById ('magnet_content');
                        var child = content.firstChild;
                        while (null != child)
                        {
                            content.removeChild (child);
                            child = content.firstChild;
                        }
                        content.appendChild (a);

                        // show the HTML code
                        var div = document.createElement ("div");
                        text = document.createTextNode (content.innerHTML);
                        div.appendChild (text);
                        content.appendChild (div);
                    }

                    // callback for writing (and then reading back) the torrent file
                    function callback (filename, torrent)
                    {
                        showcontent (torrent, "torrent_content");
                        showmagnet (torrent);
                    }

                    // called on form submit
                    function submit_form ()
                    {
                        if (null == Torrent)
                            Torrent = MakeTorrent ();

                        Torrent["info"]["thing"] = {};
                        var thing = Torrent["info"]["thing"];
                        var form = document.getElementById ('thing_form');
                        if (null != form)
                        {
                            for (i = 0; i < form.elements.length; i++)
                            {
                                var child = form.elements[i];
                                var id = child.getAttribute ("id");
                                if (null != id)
                                {
                                    var value = child.value;
                                    if ((null != value) && ("" != value))
                                    {
                                        thing[id] = value;
                                        // kludge here to handle the lists
                                        if (("authors" == id) || ("licenses" == id) || ("tags" == id))
                                            thing[id] = value.split (',');
                                        // kludge here to set the name
                                        if ("title" == id)
                                            if (null == TorrentFileName)
                                                TorrentFileName = title + ".torrent";
                                    }
                                }
                            }
                        }

                        var output = encode (Torrent);
                        showlink (output);
                        ReadStringAsync (TorrentFileName, output, callback);
                        enablesigning ();
                    }

                    // called on form submit
                    function sign_thing ()
                    {
                        if (null != Torrent)
                        {
                            var privatekey = document.getElementById ('private_key').value;
                            var certificate = document.getElementById ('certificate').value;
                            var version = document.getElementById ('version').value;
                            var nonce = document.getElementById ('nonce').value;
                            var next_nonce = document.getElementById ('next_nonce').value;

                            if ("" != version)
                            {
                                SignTorrent (Torrent, privatekey, certificate, version, nonce, next_nonce);
                                var output = encode (Torrent);
                                showlink (output);
                                ReadStringAsync (TorrentFileName, output, callback);
                            }
                            else
                                alert ("Version shouldn't be empty.");
                        }
                    }

                    function cb3 (sha)
                    {
                        clean_add ("file_content", format (sha));
                    }

                    function tohex (val)
                    {
                        var str = "";
                        var i;
                        var v;

                        for (i = 7; i >= 0; i--)
                        {
                            v = (val >>> (i * 4)) & 0x0f;
                            str += v.toString (16);
                        }
                        return str;
                    };

                    function cb4 (filename, torrent)
                    {
                        Torrent = torrent;
                        showcontent (torrent, "file_content");
                        var info = Torrent["info"];
                        var primary_key = info_hash (info);
                        clean_add ("info_hash", document.createTextNode ("Info Hash: " + primary_key));
                    }

                    document.querySelector ('#thing_files').addEventListener ('change', function (evt)
                    {
                        if (evt.target.tagName.toLowerCase () == 'input')
                        {
                            var files;

                            files = document.getElementById ('thing_files').files;
                            if (0 != files.length)
                            {
                                if ((1 == files.length) && (-1 != files[0].name.indexOf (".torrent", files[0].name.length - ".torrent".length)))
                                {
                                    TorrentFileName = files[0].name;
                                    ReadTorrentAsync (files[0], cb4);
                                }
                                else
                                {
                                    ReadFilesAsync (files, 16384, cb3);
                                    if (null != Files && (1 == Files.length))
                                        enablebutton ();
                                }
                            }
                            else
                                alert ('Please select a file.');
                        }
                    }, false);
                    document.querySelector ('#thing_directory').addEventListener ('keyup', function (evt)
                    {
                        if (evt.target.tagName.toLowerCase () == 'input')
                        {
                            var dir;
                            dir = document.getElementById ('thing_directory').value;
                            dir = dir.trim ();
                            if (0 != dir.length)
                            {
                                Directory = dir;
                                enablebutton ();
                            }
                            else
                            {
                                Directory = null;
                                disablebutton ();
                            }
                        }
                    }, false);
                    document.querySelector ('#torrent_files').addEventListener ('change', function (evt)
                    {
                        if (evt.target.tagName.toLowerCase () == 'input')
                        {
                            var files;

                            files = document.getElementById ('torrent_files').files;
                            if (0 != files.length)
                                ReadTorrentAsync (files[0], cb);
                            else
                                alert ('Please select a file.');
                        }
                    }, false);
                </script>
</body>
</html>

